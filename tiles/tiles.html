<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Tiles</title>
    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
    
    <style type="text/css">
        img.tile {
            margin: 0px;
            position: absolute;
            cursor: pointer;
        }
        
        img.palette {
            margin: 12px;
            cursor: pointer;
        }
    </style>

    <script type="text/javascript">

        var board;

        function initBoard() {
            board = new Board();
            board.drawBoard();
            board.drawPalette();
        }

        function Board() {
            // variables
            this.currentPaletteItemIndex = -1;

            // constants
            this.rows = 12;
            this.cols = 10;
            this.tileSz = 48;
            this.tileSz2 = 24;
            this.tileSz4 = 12;
                        
            // constants - tile types
            this.TileGrass = 0;
            this.TileSand = 1;

            this.tileImage = {};
            this.tileImage[this.TileGrass] = 'tile_small_grass.png';
            this.tileImage[this.TileSand] = 'tile_small_sand.png';

            // cells array
            this.cells = new Array(this.rows);
            for (var i = 0; i < this.rows; i++) {
                this.cells[i] = new Array(cols);
                for (var j = 0; j < this.cols; j++) {
                    this.cells[i][j] = this.TileGrass;
                }
            }

            // draw board as is
            this.drawBoard = function () {
                var canvas = $('div#boardCanvas');
                var strInnerHtml = '';

                for (var row = 0; row < this.rows; row++)
                    for (var col = 0; col < this.cols; col++) {
                        // coords
                        var xCoord = this.tileSz * col;
                        var yCoord = (this.tileSz - this.tileSz4) * row;
                        var rowEven = (row % 2 == 0);
                        if (!rowEven)
                            xCoord += this.tileSz2;
                        
                        // img file
                        var tileIndex = this.cells[row][col];
                        var tileImgStr = this.tileImage[tileIndex];

                        // img tag itself
                        var strStyle = 'style="left: ' + xCoord + 'px; top: ' + yCoord + 'px"';
                        var strTag = '<img src="pic/' + tileImgStr +  '" class="tile" ' + strStyle + '/>\n';
                        strInnerHtml = strInnerHtml + strTag;
                    }
                canvas.html(strInnerHtml);
            };

            // draw palette that is used for choosing board tiles
            this.drawPalette = function () {
                var canvas = $('div#boardPalette');
                var strInnerHtml = ''; // 

                for (var i = 0; i < Object.keys(this.tileImage).length; i++) {
                    var tileImgStr = this.tileImage[i];
                    var strTag = '<img src="pic/' + tileImgStr + '" class="palette" ' +
                        'onclick="board.choosePaletteItem(' + i + ')"' + '/>\n';
                    strInnerHtml = strInnerHtml + strTag;
                }
                canvas.html(strInnerHtml);
            }

            // choose cell type from palette
            this.choosePaletteItem = function (itemIndex) {
                this.currentPaletteItemIndex = itemIndex;
            }
        }

        function boardCellClicked() {
        }


    </script>
</head>
<body onload="initBoard()">
    <div id="boardCanvas">

    </div>

    <h3>Choose tile:</h3>
    <div id="boardPalette" style="position: absolute; top:600px">

    </div>
</body>
</html>